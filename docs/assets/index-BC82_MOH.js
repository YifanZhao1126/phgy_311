var I=(o,t,s)=>new Promise((i,l)=>{var a=u=>{try{y(s.next(u))}catch(h){l(h)}},c=u=>{try{y(s.throw(u))}catch(h){l(h)}},y=u=>u.done?i(u.value):Promise.resolve(u.value).then(a,c);y((s=s.apply(o,t)).next())});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();class k{constructor(t=null){this.seed=t!==null?t:Date.now()^Math.random()*4294967295,this.state=this.seed}random(){let t=this.state+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}randn(){const t=this.random(),s=this.random();return Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*s)}}class L extends k{constructor(t=null){super(t)}next(){return this.randn()}}function q(o,t,s=null){return I(this,null,function*(){const i=new L;o===3?(t.gmax=.015*125,t.yConst=15):(t.gmax=.015*50,t.yConst=2);const l=new Array(t.N).fill(0);if(o===2)for(let n=0;n<t.N/2;n++)l[n]=1;if(o===3){for(let n=0;n<t.N/2;n++)l[n]=1;for(let n=Math.floor(t.N/2);n<t.N;n++)l[n]=2}const a=1;let c=t.Vrest;const y=new Array(t.N).fill(0);let u=0;const h=new Array(t.N).fill(-9999999),d=new Array(t.N).fill(0),f=new Array(t.N).fill(0),m=new Array(t.N);for(let n=0;n<t.N;n++)m[n]=Math.min(Math.max(i.random()*t.gmax,0),t.gmax);let x=Math.round(Math.max(1,t.corr_time+i.randn())),w=Math.round(Math.max(1,t.corr_time+i.randn())),g=new Array(t.N),b;for(let n=0;n<t.N;n++)g[n]=i.randn();for(let n=0;n<t.N;n++)l[n]===0&&(d[n]=10*(1+.3*Math.sqrt(2)*g[n]));let B=0;if(l.some(n=>n===1)){B=1;for(let n=0;n<t.N;n++)g[n]=i.randn();b=i.randn();for(let n=0;n<t.N;n++)l[n]===1&&(d[n]=10*(1+.3*Math.sqrt(2)*g[n]+t.yConst*b))}let _=0;if(l.some(n=>n===2)){_=1;for(let n=0;n<t.N;n++)g[n]=i.randn();b=i.randn();for(let n=0;n<t.N;n++)l[n]===2&&(d[n]=10*(1+.3*Math.sqrt(2)*g[n]+t.yConst*b))}for(let n=0;n<t.N;n++)d[n]=Math.max(d[n],0);for(let n=0;n<t.N;n++)l[n]===0&&(f[n]=1-Math.exp(-d[n]*.001)),l[n]===1&&(f[n]=1-Math.exp(-d[n]*.001)),l[n]===2&&(f[n]=1-Math.exp(-d[n]*.001));for(let n=1;n<=t.stime;n++){if(n%x===0){for(let e=0;e<t.N;e++)g[e]=i.randn();for(let e=0;e<t.N;e++)l[e]===0&&(d[e]=10*(1+.3*Math.sqrt(2)*g[e]));x=Math.round(Math.max(1,t.corr_time+i.randn()));for(let e=0;e<t.N;e++)g[e]=i.randn();if(b=i.randn(),B)for(let e=0;e<t.N;e++)l[e]===1&&(d[e]=10*(1+.3*g[e]+t.yConst*b),f[e]=1-Math.exp(-d[e]*.001));for(let e=0;e<t.N;e++)l[e]===0&&(f[e]=1-Math.exp(-d[e]*.001));for(let e=0;e<t.N;e++)d[e]=Math.max(d[e],0)}if(_&&n%w===0){for(let e=0;e<t.N;e++)g[e]=i.randn();b=i.randn(),w=Math.round(Math.max(1,t.corr_time+i.randn()));for(let e=0;e<t.N;e++)l[e]===2&&(d[e]=10*(1+.3*g[e]+t.yConst*b),f[e]=1-Math.exp(-d[e]*.001))}let C=0;for(let e=0;e<t.N;e++)C+=m[e]*Math.exp(-(n-h[e])/t.tau_ex);const M=(t.Vrest-c+C*(t.Eex-c))/t.tau_m;c=c+M*a;let z=0;if(c>=t.Vth){c=-60,z=1;for(let e=0;e<t.N;e++)m[e]=m[e]+t.gmax*t.A_ltp*y[e]}const N=(-u+z)/t.tau_ltd,E=new Array(t.N);for(let e=0;e<t.N;e++)E[e]=i.random()<=f[e]?1:0,E[e]&&(h[e]=n+1);const r=new Array(t.N);for(let e=0;e<t.N;e++)r[e]=(-y[e]+E[e])/t.tau_ltp;for(let e=0;e<t.N;e++)E[e]&&(m[e]=m[e]-t.gmax*t.A_ltd*u);for(let e=0;e<t.N;e++)y[e]=y[e]+r[e]*a;u=u+N*a;for(let e=0;e<t.N;e++)m[e]=Math.max(Math.min(m[e],t.gmax),0);if(s&&n%1e4===0){const e=m.map(W=>W/t.gmax);yield s(n,t.stime,e)}}return m.map(n=>n/t.gmax)})}function O(o,t=null){return I(this,null,function*(){const s=new L,i=1,l=-50,a=50,c=a-l+1,y=new Array(o.N);for(let x=0;x<o.N;x++)y[x]=s.next()*o.latency_std;const u=new Array(o.N).fill(.003),h=1-Math.exp(-o.burstrate*.001),d=new Array(o.N).fill(0);let f=0,m=null;for(let x=1;x<=o.ttimes;x++){const w=new Array(o.N).fill(-9999999);let g=o.Vrest;const b=new Array(c).fill(0);let B=0;for(let _=l;_<=a;_++){let n=0;for(let r=0;r<o.N;r++)n+=u[r]*Math.exp(-(_-w[r])/o.tau_ex);const C=(o.Vrest-g+n*(o.Eex-g))/o.tau_m;g=g+C*i,b[B]=g;let M=0;if(g>=o.Vth){g=-60,b[B]=0,M=1;for(let r=0;r<o.N;r++)u[r]=u[r]+o.gmax*o.A_ltp*d[r]}const z=(-f+M)/o.tau_ltd,N=new Array(o.N);for(let r=0;r<o.N;r++){const e=_>=y[r]&&_<y[r]+o.burstdur;N[r]=s.random()<=h&&e?1:0,N[r]&&(w[r]=_+1)}const E=new Array(o.N);for(let r=0;r<o.N;r++)E[r]=(-d[r]+N[r])/o.tau_ltp;for(let r=0;r<o.N;r++)N[r]&&(u[r]=u[r]-o.gmax*o.A_ltd*f);for(let r=0;r<o.N;r++)d[r]=d[r]+E[r]*i;f=f+z*i;for(let r=0;r<o.N;r++)u[r]=Math.max(Math.min(u[r],o.gmax),0);B++}if(x===1&&(m=[...b]),t&&x%100===0){const _=u.map(n=>n/o.gmax);yield t(x,o.ttimes,y,_,b,m)}}return{latencies:y,weights:u.map(x=>x/o.gmax)}})}var v={responsive:!0},T={title:"<b>Uncorrelated ↔ Uncorrelated</b>",xaxis:{title:"<b>Input Neuron</b>",range:[0,100],zeroline:!1},yaxis:{title:"<b>g/g<sub>max</sub></b>",range:[0,1],zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},U={title:"<b>Correlated ↔ Uncorrelated</b>",xaxis:{title:"<b>Input Neuron</b>",range:[0,100],zeroline:!1},yaxis:{title:"<b>g/g<sub>max</sub></b>",range:[0,1],zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},R={title:"<b>Correlated ↔ Correlated</b>",xaxis:{title:"<b>Input Neuron</b>",range:[0,100],zeroline:!1},yaxis:{title:"<b>g/g<sub>max</sub></b>",range:[0,1],zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},D={title:"<b>Weight Distribution</b>",xaxis:{title:"<b>g/g<sub>max</sub></b>",zeroline:!1},yaxis:{title:"<b>Count</b>",zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},G={title:"<b>Initial Synaptic Weights</b>",xaxis:{title:"<b>Latency (ms)</b>",range:[-55,55],zeroline:!1},yaxis:{title:"<b>g/g<sub>max</sub></b>",range:[0,1],zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},H={title:"<b>Initial Voltage Trace</b>",xaxis:{title:"<b>Time (ms)</b>",range:[-50,50],zeroline:!1},yaxis:{title:"<b>Voltage (mV)</b>",range:[-80,0],zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},K={title:"<b>Synaptic Weights</b>",xaxis:{title:"<b>Latency (ms)</b>",range:[-55,55],zeroline:!1},yaxis:{title:"<b>g/g<sub>max</sub></b>",range:[0,1],zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},j={title:"<b>Voltage Trace</b>",xaxis:{title:"<b>Time (ms)</b>",range:[-50,50],zeroline:!1},yaxis:{title:"<b>Voltage (mV)</b>",range:[-80,0],zeroline:!1},autosize:!0,paper_bgcolor:"#c7c7c7",showlegend:!1},p=!1;function J(){return{N:parseInt(document.getElementById("N").value),tau_ltp:parseFloat(document.getElementById("tau_ltp").value),tau_ltd:parseFloat(document.getElementById("tau_ltp").value),A_ltp:parseFloat(document.getElementById("A_ltp").value),A_ltd:parseFloat(document.getElementById("A_ltp").value)*parseFloat(document.getElementById("B").value),gmax:parseFloat(document.getElementById("gmax").value),Vrest:parseFloat(document.getElementById("Vrest").value),Vth:parseFloat(document.getElementById("Vth").value),tau_m:parseFloat(document.getElementById("tau_m").value),stime:parseInt(document.getElementById("stime").value),tau_ex:parseFloat(document.getElementById("tau_ex").value),Eex:parseFloat(document.getElementById("Eex").value),corr_time:parseFloat(document.getElementById("corr_time").value),yConst:parseFloat(document.getElementById("yConst").value)}}function Q(){var o={x:[],y:[],mode:"markers",type:"scatter",marker:{color:"rgb(0, 0, 0)",size:6},cliponaxis:!1};Plotly.newPlot("condition1Chart",[o],T,v),Plotly.newPlot("condition2Chart",[o],U,v),Plotly.newPlot("condition3Chart",[o],R,v);var t={x:[],type:"histogram",marker:{color:"rgba(0, 0, 0, 0.7)"},xbins:{start:0,end:1,size:.1}};Plotly.newPlot("histogramChart",[t],D,v)}function P(o,t){for(var s="condition"+o+"Chart",i=[],l=[],a=0;a<t.length;a++)i.push(a),l.push(t[a]);Plotly.restyle(s,{x:[i],y:[l]},[0])}function X(o){Plotly.restyle("histogramChart",{x:[o]},[0])}function A(o){return I(this,null,function*(){if(!p){p=!0;var t=["runCondition1","runCondition2","runCondition3"];t.forEach(function(c){document.getElementById(c).disabled=!0});var s={1:"Uncorrelated ↔ Uncorrelated",2:"Correlated ↔ Uncorrelated",3:"Correlated ↔ Correlated"};document.getElementById("status").textContent="Running "+s[o]+"...";var i=J();try{var l=function(c,y,u){return I(this,null,function*(){if(!p)throw new Error("Stopped");var h=c/y*100;document.getElementById("progressBar").style.width=h+"%",document.getElementById("status").textContent=s[o]+": "+Math.round(h)+"%",P(o,u),yield new Promise(function(d){setTimeout(d,5)})})},a=yield q(o,i,l);P(o,a),X(a),document.getElementById("progressBar").style.width="100%",document.getElementById("status").textContent=s[o]+" completed"}catch(c){c.message!=="Stopped"&&(console.error("Simulation error:",c),document.getElementById("status").textContent="Error occurred")}p=!1,t.forEach(function(c){document.getElementById(c).disabled=!1})}})}function Y(){p=!1,document.getElementById("status").textContent="Simulation stopped";var o=["runCondition1","runCondition2","runCondition3"];o.forEach(function(t){document.getElementById(t).disabled=!1})}var F=!1,V=!1;function Z(){return{N:parseInt(document.getElementById("f4_N").value),tau_ltp:parseFloat(document.getElementById("f4_tau_ltp").value),tau_ltd:parseFloat(document.getElementById("f4_tau_ltp").value),A_ltp:parseFloat(document.getElementById("f4_A_ltp").value),A_ltd:parseFloat(document.getElementById("f4_A_ltp").value)*parseFloat(document.getElementById("f4_B").value),gmax:parseFloat(document.getElementById("f4_gmax").value),Vrest:parseFloat(document.getElementById("f4_Vrest").value),Vth:parseFloat(document.getElementById("f4_Vth").value),tau_m:parseFloat(document.getElementById("f4_tau_m").value),tau_ex:parseFloat(document.getElementById("f4_tau_ex").value),Eex:parseFloat(document.getElementById("f4_Eex").value),ttimes:parseInt(document.getElementById("f4_ttimes").value),latency_std:parseFloat(document.getElementById("f4_latency_std").value),burstdur:parseFloat(document.getElementById("f4_burstdur").value),burstrate:parseFloat(document.getElementById("f4_burstrate").value)}}function S(){if(!V){V=!0;var o={x:[],y:[],mode:"markers",type:"scatter",marker:{color:"rgb(0, 0, 0)",size:4},cliponaxis:!1},t={x:[],y:[],mode:"lines",type:"scatter",line:{color:"rgb(0, 0, 0)",width:2}};Plotly.newPlot("f4_initialWeights",[o],G,v),Plotly.newPlot("f4_initialVoltage",[t],H,v),Plotly.newPlot("f4_currentWeights",[o],K,v),Plotly.newPlot("f4_currentVoltage",[t],j,v)}}function $(){return I(this,null,function*(){if(!F){S(),F=!0,document.getElementById("runFigure4").disabled=!0,document.getElementById("f4_status").textContent="Initializing...";var o=Z();try{var t=function(i,l,a,c,y,u){return I(this,null,function*(){if(!F)throw new Error("Stopped");var h=i/l*100;if(document.getElementById("f4_progressBar").style.width=h+"%",document.getElementById("f4_status").textContent="Iteration "+i+"/"+l,i===100&&(Plotly.restyle("f4_initialWeights",{x:[a],y:[new Array(a.length).fill(.003/o.gmax)]},[0]),u)){for(var d=[],f=0;f<u.length;f++)d.push(-50+f);Plotly.restyle("f4_initialVoltage",{x:[d],y:[u]},[0])}Plotly.restyle("f4_currentWeights",{x:[a],y:[c]},[0]);for(var m=[],f=0;f<y.length;f++)m.push(-50+f);Plotly.restyle("f4_currentVoltage",{x:[m],y:[y]},[0]),yield new Promise(function(x){setTimeout(x,1)})})},s=yield O(o,t);Plotly.restyle("f4_currentWeights",{x:[s.latencies],y:[s.weights]},[0]),document.getElementById("f4_progressBar").style.width="100%",document.getElementById("f4_status").textContent="Simulation completed"}catch(i){i.message!=="Stopped"&&(console.error("Simulation error:",i),document.getElementById("f4_status").textContent="Error occurred")}F=!1,document.getElementById("runFigure4").disabled=!1}})}function tt(){F=!1,document.getElementById("f4_status").textContent="Simulation stopped",document.getElementById("runFigure4").disabled=!1}function et(){var o=document.querySelectorAll(".tab-button"),t=document.querySelectorAll(".tab-content");o.forEach(function(s){s.addEventListener("click",function(){var i=s.getAttribute("data-tab");o.forEach(function(l){l.classList.remove("active")}),s.classList.add("active"),t.forEach(function(l){l.classList.remove("active")}),document.getElementById(i).classList.add("active"),i==="figure4"&&S()})})}document.addEventListener("DOMContentLoaded",function(){Q(),et(),document.getElementById("runCondition1").addEventListener("click",function(){A(1)}),document.getElementById("runCondition2").addEventListener("click",function(){A(2)}),document.getElementById("runCondition3").addEventListener("click",function(){A(3)}),document.getElementById("stopSimulation").addEventListener("click",Y),document.getElementById("runFigure4").addEventListener("click",$),document.getElementById("stopFigure4").addEventListener("click",tt)});
